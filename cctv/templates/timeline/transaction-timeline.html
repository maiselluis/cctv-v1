
{% extends 'base.html'%}
 {% block title %} CCTV @ CRC | Transaction Timeline
 {% load static %}
 {% endblock%}
 {%block content_header%}
 <div class="app-content-header"> <!--begin::Container-->
  <div class="container-fluid"> <!--begin::Row-->
      <div class="row">
          <div class="col-sm-6">
              <h3 class="mb-0"> Timeline</h3>
             
          </div>
          <div class="col-sm-6">
              <ol class="breadcrumb float-sm-end">
                  <li class="breadcrumb-item"><a  href={% url 'index' %}>Home</a></li>
                  <li class="breadcrumb-item active" aria-current="page"> <a  href={% url 'cash_desk_transactions-list' %}>Cash Desk Transactions</a> </li>
                  <li class="breadcrumb-item active" aria-current="page">
                    Transaction Timeline
                  </li>
              </ol>
          </div>
      </div> <!--end::Row-->
  </div> <!--end::Container-->
</div>

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css">
<style>
 .timeline {
    position: relative;
    max-width: 1000px;
    margin: auto;
    padding: 20px 0;
}

.timeline::after {
    content: '';
    position: absolute;
    width: 4px;
    background-color: #007bff;
    top: 0;
    bottom: 0;
    left: 50%;
    margin-left: -2px;
}

.timeline-item {
    position: relative;
    width: 50%;
    padding: 20px 40px;
    box-sizing: border-box;
}

/* Izquierda */
.timeline-item.left {
    left: 0;
    text-align: right;
}

/* Derecha */
.timeline-item.right {
    left: 50%;
    text-align: left;
}

/* Card content */
.timeline-item .content {
    background-color: #fff;
    padding: 20px;
    border-radius: 6px;
    position: relative;
    box-shadow: 0 2px 10px rgba(0,0,0,0.2);
    width: 100%;
}

/* Flechas */
.timeline-item.right::before, .timeline-item.left::before {
    content: "";
    position: absolute;
    top: 30px;
    width: 0;
    height: 0;
    border-style: solid;
}

.timeline-item.right::before {
    left: -15px;
    border-width: 8px 15px 8px 0;
    border-color: transparent white transparent transparent;
}

.timeline-item.left::before {
    right: -15px;
    border-width: 8px 0 8px 15px;
    border-color: transparent transparent transparent white;
}

/* Imagen circular */
.timeline-item img {
    width: 50px;
    height: 50px;
    border-radius: 50%;
}
.timeline-item.left .content {
    text-align: left; /* Asegura que el texto esté alineado a la izquierda */
    margin-left: auto; /* Empuja el contenido hacia el lado derecho del contenedor izquierdo */
}


/* Responsive */
@media screen and (max-width: 768px) {
    .timeline::after {
        left: 90px;
    }

    .timeline-item {
        width: 100%;
        padding-left: 120px;
        padding-right: 25px;
    }

    .timeline-item.left, .timeline-item.right {
        left: 0;
        text-align: left;
    }

    .timeline-item.left::before, .timeline-item.right::before {
        left: 100px;
        border: medium none;
        border-left: 10px solid white;
        top: 25px;
    }
    }
    /* Estado inicial de animación */
.timeline-item {
    opacity: 0;
    transform: translateY(40px);
    transition: all 0.6s ease-out;
}

/* Cuando entra en el viewport */
.timeline-item.show {
    opacity: 1;
    transform: translateY(0);
}


</style>
 {%endblock%}
 {%block content%}

 <div class="card card-primary card-outline mb-4">
    <div class="card-header">
        <form method="get"> 
            <div class="container-fluid">
                <div class="row d-flex justify-content-end"> 
                    <div class="col-sm-auto d-flex align-items-center"> 
                        <label class="card-title text-start"> <strong> Transactions by Customers Timeline </strong></label>
                    </div>
    
                    <div class="col-sm-auto d-flex justify-content-end"> 
                        {{ form.location }}
                    </div>
    
                    <div class="col-sm-auto d-flex align-items-center">                  
                        <label class="card-title text-start">{{ form.date_begin.label_tag }}</label>            
                    </div> 
                    <div class="col-sm-auto d-flex justify-content-end"> 
                        {{ form.date_begin }}
                    </div> 
    
                    <div class="col-sm-auto d-flex align-items-center">     
                        <label class="card-title text-start">{{ form.date_end.label_tag }}</label> 
                    </div> 
                    <div class="col-sm-auto d-flex justify-content-end">     
                        {{ form.date_end }}
                    </div> 
    
                    <div class="col-sm-auto d-flex align-items-center">                  
                        <label class="card-title text-start">{{ form.customer.label_tag }}</label>            
                    </div> 
                    <div class="col-sm-auto d-flex justify-content-end"> 
                        {{ form.customer }} 
                    </div> 
    
                    <div class="col-sm-auto">     
                        <button class="btn btn-primary" type="submit">Find</button>               
                    </div>  
                </div>                  
            </div>                                                  
        </form>  
    </div>
    
      <div class="card-body">
      {% if transactions %}
                    <div class="timeline">
                        {% for transaction in transactions %}
                            <div class="timeline-item {% cycle 'left' 'right' %}">
                                <div class="content">
                                    <h5>{{ transaction.date }} - {{ transaction.time }}</h5>
                                    {% if transaction.customer %}
                                    <p> <i class="bi bi-person-circle"> Customer</i> :   <img src="{{ transaction.customer.photo.url }}" alt="Customer Photo">
                                        <strong>{{ transaction.customer.customer }}</strong></p>
                                  {% else %}
                                  <p> <i class="bi bi-person-circle"> Customer</i> :  <img src="/media/images/noimage.jpg" alt="No Customer Photo">
                                    
                                      <strong>No Customer</strong></p>
                                    {% endif %}
                                    <hr>
                                    <p><i class="bi bi-cash-stack"></i> Amount by Currency</i>: 
                                        TT${{ transaction.tt_dolar|floatformat:2 }} |  
                                        <i class="bi bi-currency-dollar"></i>{{ transaction.usd_dolar|floatformat:2 }} | 
                                        <i class="bi bi-currency-euro"></i>{{ transaction.euro_dolar|floatformat:2 }}  
                                       
                                    </p>
                                    <hr>
                                    <p><i class="bi bi-bank"> Account Type</i>: {{ transaction.account_type }}</p>
                                    <hr>
                                    <p> <i class="bi bi-pc-display-horizontal"> Cashier </i>: {{ transaction.area_cashier }}</p>
                                   <hr>
                                    {% if transaction.employee %}
                                    <p><i class="bi bi-person-standing"> Employee </i>: <img src="{{ transaction.employee.photo.url }}" alt="Employee Photo"> {{ transaction.employee }}</p>
                                    {% else %}
                                    <p>    <i class="bi bi-person-standing">Employee</i>: <img src="/media/images/noimage.jpg" alt="No Employee Photo"> No Employee </p>
                                   {% endif %}
                                   <hr>
                                   <p> <i class="bi bi-buildings"> Branch: </i>: {{ transaction.location }}</p>
                                 
                                </div>
                            </div>
                        {% endfor %}
                    </div>
                 
               
                    {% endif%}
      </div>
      <div class="card-footer">
       
        <a class="btn btn-secondary mb-2 bi-chevron"  href="{% url 'index' %}" > <i class="bi bi-arrow-left"> </i> Back</a> 
             
         
            </div>
 </div>



 <script>
    document.addEventListener("DOMContentLoaded", function () {
        const items = document.querySelectorAll(".timeline-item");
    
        const observer = new IntersectionObserver((entries) => {
            entries.forEach((entry) => {
                if (entry.isIntersecting) {
                    entry.target.classList.add("show");
                    observer.unobserve(entry.target); // Animar solo una vez
                }
            });
        }, {
            threshold: 0.1
        });
    
        items.forEach((item) => {
            observer.observe(item);
        });
    });
    </script>
    

{% endblock%}
